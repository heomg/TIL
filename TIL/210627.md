
---

# 06-27-2021

## android
### 액티비티 생명 주기  
안드로이드 시스템은 액티비티 인스턴스를 제어할 때 인스턴스의 상태에 맞는 콜백 메소드를 호출한다. 

- onCreate
  - 시스템이 액티비티를 생성하면서
    - 액티비티는 생성됨 상태가 되고
    - onCreate 메소드가 호출됨
  - 활동의 전체 수명 주기 동안 한 번만 발생해야 하는 로직 실행
    - activity을 View Model 연결
    - 일부 클래스 범위 변수의 인스턴스화
  - Bundle 객체를 인자로 받아서 이전 저장 상태 수신
    - 처음 생성될 때 Bundle 객체 값은 null임
  - onCreate 완료 후에는 액티비티가 시작됨 상태가 됨
- onStart
  - 액티비티가 시작됨 상태가 되면서 onStart가 호출됨
  - onStart가 호출되면 액티비티가 사용자에게 표시됨
  - 액티비티가 포그라운드로 보내지도록 준비함
    - **앱이 UI를 관리하는 코드를 초기화**
    - *액티비티가 화면에 표시만 되고 아직 포그라운드로 보내지기 전* 
    - *액티비티가 포그라운드에 보내져야지만 상호작용 가능*
  - 수명 주기 인식 구성요소가 ON_START 이벤트 수신
  - 잠깐 동안만 실행됨
  - onStart 완료 후에는 액티비티가 재개됨 상태에 들어감
  
- onResume
  - 액티비티가 재개됨 상태가 되면서
    - 앱이 포그라운드에 표시되고
    - onResume이 호출됨
  - 이 상태에 들어갔을 때 앱이 사용자와 상호작용함
  - 수명 주기 인식 구성요소가 ON_RESUME 이벤트 수신
    - 카메라 활성화를 ON_START 이벤트를 수신했을 때 할 경우
      - 액티비티가 일시중지됨 상태일 때도 카메라 활성화됨
    - 카메라 활성화를 ON_RESUME 이벤트를 수신했을 떄 할 경우
      - 액티비티가 일시중지됨 상태일 때 카메라 비활성화됨
    - **ON_START 이벤트 때 초기화 한 것은 ON_STOP 이벤트 이후에 해제**
    - **ON_RESUME 이벤트 떄 초기화 한 것은 ON_PAUSE 이벤트 이후에 해제**
  - 방해되는 이벤트가 발생하면(*전화?*)
    - 액티비티가 일시중지됨 상태가 되고
    - onPause 호출
- onPause
  - 액티비티가 일시중지됨 상태가 됐을 때 onPause 호출
    - 일시중지됨 상태가 되는 이유
      - 일부 이벤트가 앱 실행을 방해했을 때
      - 멀티 윈도우 모드에서 포커스 받지 못 했을 때
      - 새로운 반투명 활동이 열렸을 때
        - 활동이 부분적으로 보이지만 포커스 상태가 아닌 경우
  - 부하가 큰 작업(데이터 저장, 네트워크 호출, 데이터베이스 트랜잭션)은 메서드 실행이 끝나기 전에 완료되지 못할 수도 있음
- onStop
  - 활동이 사용자에게 더 이상 표시되지 않으면
    - 액티비티는 중단됨 상태에 들어가고
    - onStop 메소드 호출
  - 중단됨 상태에 들어가면 액티비티 객체는 메모리에 있지만 창 관리자와 연결되어 있지는 않음
  - 시스템은 레이아웃에 있는 각 View 객체의 현재 상태도 기록하기 때문에 이를 저장 복원할 필요가 없음
  - 액티비티가 다시 시작되면 onRestart 호출
  - 실행을 종료하면 onDestory 호출

- onDestroy
  - 시스템은 다음 중 하나일 때 onDestroy 호출
    - 사용자가 활동을 완전히 닫거나 활동에서 finish()가 호출되는 경우
      - 활동이 종료되는 경우
    - 구성 변경(기기 회전 또는 멀티 윈도우 모드)으로 인해 시스템이 일시적으로 소멸시키는 경우
      - 이 경우 ViewModel은 그대로 보존됨




### Recycler view

  - 순서
    - item 레이아웃 및 item class 정의
    - adapter 및 view holder class 정의
    - recycler view와 adapter 및 layout manager 연결
    - item 추가 후 notifyDataSetChanged 메소드 호출  
      <br />
  - item 레이아웃 및 item class 정의

    - item 레이아웃
      - 예시
        - 이름 text view
        - 전화번호 text view
        ```xml
        <androidx.appcompat.widget.LinearLayoutCompat>
          <TextView android:id="@+id/itemName" />
          <TextView android:id="@+id/itemPhoneNumber" />
        </androidx.appcompat.widget.LinearLayoutCompat>
        ```
    - item class

      - item 레이아웃에 들어갈 정보를 모아둔 클래스
      - 예시

      ```java
      public class MyItem {
        String name;
        String phoneNumber;

        public MyItem(String name, String phoneNumber) {
            this.name = name;
            this.phoneNumber = phoneNumber;
        }
      ```

  - adapter 및 view holder class 정의

    - adapter class 정의
      - 프로퍼티
        - 정의한 item class 타입의 ArrayList
      - RecyclerView.Adapter 클래스 상속
        - 오버라이딩 메소드
          - onCreateViewHolder
            - inflater를 통해 item view 객체 생성
            - 생성한 item view 객체를 인자로 한 view holder 객체 생성
          - onBindViewHolder
            - position에 있는 data로 view holder가 가지고 있는 item view를 알맞게 갱신
          - geItemCount()
            - adapter가 가지고 있는 ArrayList의 길이 리턴
    - view holder class 정의

      - RecyclerView.ViewHolder 클래스 상속
      - 프로퍼티
        - 아이템 레이아웃에서 데이터가 바뀌는 뷰
      - 생성자
        - item view 객체를 인자로 받음
        - 정의한 프로퍼티와 item view 객체를 알맞게 연결
      - 예시

        ```java
        static class MyViewHolder extends RecyclerView.ViewHolder {
          TextView nameTextView;
          TextView phoneNumberTextView;

          public MyViewHolder(View itemView) {
            super(itemView);
            nameTextView = itemView.findViewById(R.id.itemName);
            phoneNumberTextView = itemView.findViewById(R.id.itemPhoneNumber);
        }
        ```

  - recycler view와 adapter 연결, recycler view와 layout manager 연결

    ```java
    // MainActivity.java
    ArrayList<MyItem> myItems = new ArrayList<>();

    // ...

    // recycler view adapter 생성
    MyRecyclerViewAdapter myRecyclerViewAdapter = new MyRecyclerViewAdapter(myItems);


    RecyclerView recyclerView = findViewById(R.id.MyRecyclerView);

    // recycler view와 adapter 연결
    recyclerView.setAdapter(myRecyclerViewAdapter);
    // recycler view와 layout manager 연결
    recyclerView.setLayoutManager(new LinearLayoutManager(this));
    ```

  - item 추가 후 notifyDataSetChanged 메소드 호출

    ```java
    // MainActivity.java
    // ArrayList에 item 추가
    myItems.add(new MyItem(name, phoneNumber));

    // notifyDataSetChanged 메소드 호출
    myRecyclerViewAdapter.notifyDataSetChanged();
    ```

  - 요약
    ![Recycler view summary, recycler view summary image](./assets/images/recycler_view_summary.jpg)
